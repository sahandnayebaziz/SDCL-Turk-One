<template name="adminSolutions">
	{{> adminNav}}
	<div class="container-fluid top-buffer-25">
		<div class="row">
			<div class="col-xs-10 col-xs-offset-1">
				{{> adminSolutionsInterior}}
			</div>
		</div>
	</div>
</template>

<template name="adminSolutionsInterior">
	<div role="tabpanel" class="tab-pane" id="solutions">

		<ul class="nav nav-tabs" role="tablist">
			<li class="nav-item">
				<a class="nav-link" href="#solutionsTable" role="tab" data-toggle="tab">Table</a>
			</li>
			<li class="nav-item">
				<a class="nav-link active" href="#solutionsView" role="tab" data-toggle="tab">View</a>
			</li>
		</ul>

		<!-- Tab panes -->
		<div class="tab-content">
			<div role="tabpanel" class="tab-pane" id="solutionsTable">
				<div class="row">
					<div class="col-md-12">
						<table class="table table-sm table-bordered bg-white">
							<thead>
							<tr>
								<th>id</th>
								<th>name</th>
								<th>explain</th>
								<th>workerId</th>
								<th>canvasNumber</th>
								<th>dateUpdated</th>
								<th>actions</th>
							</tr>
							</thead>
							<tbody>
							{{#each solutions}}
								<tr>
									<td>{{_id}}</td>
									<td>{{name}}</td>
									<td>{{explain}}</td>
									<td>{{workerId}}</td>
									<td>{{canvasNumber}}</td>
									<td>{{dateUpdated}}</td>
									<td>
										<button class="btn btn-sm btn-danger deleteSolution">delete</button>
									</td>
								</tr>
							{{/each}}
							</tbody>
						</table>
					</div>
				</div>
			</div>
			<div role="tabpanel" class="tab-pane active" id="solutionsView">
				<div class="row top-buffer-25">
					<div class="col-xs-12">
						{{#each solutions}}
							{{> solutionVisual}}
						{{/each}}
					</div>
				</div>
			</div>
		</div>
	</div>

</template>

<template name="solutionVisual">
	<div class="row bottom-buffer-100" style="height: 500px;">
		<div class="col-xs-12" id="col-sketch">
			<p><span class="text-muted">workerId: </span><a href="/worker/{{workerId}}">{{workerId}}</a></p>
			<canvas class="canvas-sketch" id="canvas{{_id}}"></canvas>
			<script>
				var idForNewCanvas = "canvas{{_id}}";
				var element = $("#" + idForNewCanvas);
				var canvas = new fabric.Canvas(idForNewCanvas);
				var canvasHeightShouldBe = 500;
				var canvasWidthShouldBe = $("#col-sketch").width();
				$(element).attr({"height": canvasHeightShouldBe, "width": canvasWidthShouldBe});

				var canvas = new fabric.Canvas(idForNewCanvas);
				canvas.isDrawingMode = false;
				canvas.setBackgroundColor("white").renderAll();
				canvas.loadFromJSON({{state}}, canvas.renderAll.bind(canvas));
				canvas.selection = false;
				canvas.forEachObject(function (o) {
					o.selectable = false;
				});
			</script>
		</div>
	</div>
</template>